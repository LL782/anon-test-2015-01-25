define(["require"],function(e){"use strict";var t={tabularList:'<ol class="tabular"></ol>',multipeCounter:'<span class="multiple-counter"></span>'},n={listHeading:"list-header",multipleItems:"has-multiple",error:"error",confirmation:"confirmation",hide:"hidden"},r=function(e,t){var n=i(e,t);if(n.$el.data("paragraphy-analyser-mod-setup"))return;n.$el.data("paragraphy-analyser-mod-setup",!0),n.$el.length>0&&n.$input.length>0&&n.$inputTrigger.length>0&&n.$outputTable.length>0&&n.$outputTallyList.length>0&&s(n)},i=function(e,t){var n={$el:e,$input:e.find(t.inputText),$inputTrigger:e.find(t.inputTrigger),$outputTable:e.find(t.outputTable),$outputTallyList:e.find(t.outputTallyList),$errorMessage:e.find(t.errorMessage),$waitingMessage:e.find(t.waitingMessage)};return n},s=function(e){e.$inputTrigger.bind("click",function(t){t.preventDefault();var n=e.$input.val(),r=o.invalid(n);u.highlight(e,r);if(r){u.clear(e);return}u.results(e,n)})},o={invalid:function(e){var t=e.length<1;return t=t||e.search(/[0-9]/g)>=0,t},output:function(e){var t=e.toLowerCase().split(" "),n=o.cleanWords(t);return o.processWords(n)},processWords:function(e){var t={table:{cols:[],maxItems:0},tally:{words:e.words.length,commas:e.numCommas,fullstops:e.numFullstops}},n="",r="",i=!1,s=!1;for(var o=0;o<e.words.length;o++){n=e.words[o],r=n.charAt(0),i=!1,s=!1;for(var u=0;u<t.table.cols.length;u++)if(t.table.cols[u].letter===r){i=u;break}if(i!==!1){for(var a=0;a<t.table.cols[i].words.length;a++)t.table.cols[i].words[a].word===n&&(s=a);s!==!1?t.table.cols[i].words[s].quantity++:(t.table.cols[i].words.push({word:n,quantity:1}),t.table.maxItems=t.table.cols[i].words.length>t.table.maxItems?t.table.cols[i].words.length:t.table.maxItems)}else t.table.cols.push({letter:r,words:[{word:n,quantity:1}]})}return t},cleanWords:function(e){var t=0,n=0;for(var r=0;r<e.length;r++)e[r]===""?e.splice(r,1):(t+=(e[r].match(/\,/g)||[]).length,n+=(e[r].match(/\./g)||[]).length,e[r]=e[r].replace(/[\.,\,]/g,""));e.sort();var i={words:e,numCommas:t,numFullstops:n};return i}},u={highlight:function(e,t){e.$errorMessage.removeClass(t?n.confirmation:n.error).addClass(t?n.error:n.confirmation)},clear:function(e){e.$outputTable.empty(),e.$outputTallyList.empty(),e.$waitingMessage.removeClass(n.hide)},results:function(e,t){u.clear(e),e.$waitingMessage.addClass(n.hide);var r=o.output(t);u.tally(e,r.tally),u.table(e,r.table)},tally:function(e,t){e.$outputTallyList.append("<li>Words: "+t.words+"</li>"),e.$outputTallyList.append("<li>Commas: "+t.commas+"</li>"),e.$outputTallyList.append("<li>Fullstops: "+t.fullstops+"</li>")},table:function(e,t){e.$outputTable.attr("data-vis-cols",t.cols.length);for(var n=0;n<t.cols.length;n++)e.$outputTable.append(u.column(e,t.cols[n],t.maxItems))},column:function(e,r,i){var s=$(t.tabularList),o=$("<li>").addClass(n.listHeading).text(r.letter.toUpperCase());s.append(o);for(var u=0;u<i;u++){o=$("<li>");if(r.words[u]){o.text(r.words[u].word);if(r.words[u].quantity>1){var a=$(t.multipeCounter).text("("+r.words[u].quantity+")");o.append(a).addClass(n.multipleItems)}}s.append(o)}return s}};return{init:r}});